<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>03.컴포넌트 연습 2 - 데이터전달/이벤트호출</title>
    <style>
        .tit {
            text-align: center;
            font-size: max(3vw,25px);
        }
        .grid{
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-column-gap: min(10px, 1vw);
            grid-row-gap: min(1.5vw, 15px);
        }   
        .grid>div{
            position: relative;
            aspect-ratio: 280/400;
            overflow: hidden;
        }
        
        .grid img{
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: .3s ease-out;
        }

        .grid>div:hover img{
            animation: magAni .8s ease-in-out infinite alternate;
        }
        @keyframes magAni {
            to{
                transform: scale(1.2);
            }
        }
        .grid aside{
            position: absolute;
            bottom: 0;
            width: 100%;
            text-align: center;
            color: #fff;
            background-color: #00000060;
        }
        .grid aside h2{
            font-size: min(1.8vw, 24px);
            font-weight: normal;
            margin: min(1.2vw, 14px) 0 0;
        }
        .grid aside h3{
            font-size: min(1.4vw, 18px);
            font-weight: normal;
            margin: min(0.8vw, 10px) 0 ;
        }
        @media screen and (max-width:1100px) {
            .grid{
                grid-template-columns: repeat(4, 1fr);
            }
        }
        @media screen and (max-width:1000px) {
            .grid{
                grid-template-columns: repeat(3, 1fr);
            }
        }
        @media screen and (max-width:800px) {
            .grid{
                grid-template-columns: repeat(2, 1fr);
            }
            .grid aside h2{
                font-size: 3vw;
                font-weight: normal;
                margin: 2vw 0 0;
            }
            .grid aside h3{
                font-size: 2vw;
                font-weight: normal;
                margin: 1vw 0 ;
            }
            
        }
        @media screen and (max-width:600px) {
            body{
                margin: 0;
            }
            .grid{
                grid-template-columns: repeat(1, 1fr);
                grid-row-gap: 0;
            }
            .grid aside h2{
                font-size: 7vw;
                font-weight: normal;
                margin: 3vw 0 0;
            }
            .grid aside h3{
                font-size: 4vw;
                font-weight: normal;
                margin: 2vw 0 ;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
    <script>
        $(()=>{
            
            /******************************************
                [컴포넌트 데이터 전달 / 이벤트 호출]
                1. 부모자식 구분하기
                    1) 부모: 뷰 인스턴스 및 html 뷰대상요소
                        -> 뷰 대상요소 내부의 사용자 정의 태그
                    2) 자식: 뷰 컴포넌트 인스턴스
                    
                2. 부모의 변수를 자식에게 전달하기
                    1) props down: 속성으로 전달하고 props로 받기
                    2) 구현방법:
                        (1) 부모 사용자 정의 태그에 v-bind:내속성=값
                            설정한 후
                        (2) 자식 컴포넌트 인스턴스 옵션에 
                            props: [속성변수명, ..]
                            또는
                            props: {속성변수명: 자료형, ...}
                            -> 배열로 값을 세팅하면 자료형 무관, 객체로 값을 세팅하면
                                자료형 필터링
                            
                        -> 주의사항: 부모로부터 받은 데이터변수는 값을 새로 할당하여
                                            변경할 수 없다.

                3. 자식 컴포넌트에서 부모의 이벤트 호출하기
                    1)  $emit 으로 전달하고 2-1~2-3
                    on이벤트 설정으로 받음 2-4~2-5
                    2) 구현방법:
                        (1) 자식 컴포넌트 템플릿에서 
                            v-on:이벤트명=자식메서드 형태로 쓴 후
                        (2) 자식 컴포넌트 methods에 이벤트에 쓴 자식
                            메서드를 만들고
                        (3) this.$emit(부모가 만든 이벤트명)으로 전달
                        (4) 부모 태그에서 v-on:부모가만든이벤트명=부모메서드 형태로 쓴후
                        (5) 부모의 Vue 인스턴스 methods에 같은 이름의 메서드를 만들고
                            기능을 구현함
            ******************************************/

            //  Vue JS  인스턴스 생성용 함수
             const makeVue = x =>{
                new Vue({
                    el: x
                })
             }

            // 1. 제목에 넣을 전역 컴포넌트 만들기
            Vue.component("tit-comp", {
                template : `
                    <strong>
                        <span>Vue JS 컴포넌트 : </span>
                         쇼핑몰 갤러리 리스트
                    </strong>
                `
            }); ///////전역 컴포넌트 1

            // Vue Instance 생성하기 : 반드시 컴포넌트 아래에서 생성
            makeVue(".tit");
            makeVue(".tit2");



            //  숫자 증감 변수
            let num = 0;
            // 2. 갤러리 리스트에 넣을 전역 컴포넌트 만들기
            // 여기가 '자식' 요소 임
                Vue.component("list-comp",{
                    // v-on:click="goPapa"로 부모이벤트 호출
                    template:`
                    <div>
                        <img v-bind:src="gsrc" v-on:click="goPapa" alt="dress">
                        <aside>
                            <h2 v-text="gname"></h2>
                            <h3>{{gprice}}</h3>
                        </aside>
                    </div>
                    `,
                    // 부모에서 v-bind:속성명=값 으로 전달한 속성변수를  props:[]/{}로 받음
                    props:["haha", "myseq", "endlet"],
                    // props:{"haha" : Number}, -> 자료형이 맞음
                    // props:{"haha" : String}, -> 자료형 오류 메시지 나옴
                    // 컴포넌트 내부의 data 속성
                    data: function(){
                        return{
                            gsrc:`img_gallery/${this.haha}.jpg`,
                            gname: `Sofia23` + this.haha+ this.endlet+"-" + (this.myseq%2),
                            gprice: this.insComma(123000*this.haha/4)+`원`
                        }
                    },
                    //  컴포넌트 내부 메서드 세팅
                    methods:{
                        //  부모 이벤트 호출하기 : $emit() 메서드 사용
                        goPapa(){
                            // $emit(부모가 만든 이벤트명)
                            this.$emit("hull")
                        },

                        //정규식함수(숫자 세자리마다 콤마해주는 기능)
                        insComma(x) {
                            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                        }
                    }
                });//////////// 전역 컴포넌트 2
                

                // 리스트 Vue 인스턴스 생성하기
                // 여기가 '부모' 요소임
                new Vue({
                    el:".grid",
                    // 부모 Vue인스턴스 메서드 생성
                    methods:{
                        // 자식이벤트 전달후 실행 메서드
                        goMsg(){
                            alert("자식이 부모이벤트 전달 성공")
                        }
                    }
                })
                 /* 
                    [ 뷰JS 출력 ]
                    mustache : 
                    {{ expression }}문법을 사용해서 특정 변수를 그대로 렌더링한다.

                    v-text : 
                    특정 태그내에서 사용할 수 있으며 v-text속성을 사용해서 "텍스트"로 렌더링한다. 
                    이 때 렌더링된 텍스트는 해당 태그의 자식 노드로 들어간다.

                    v-html : 
                    특정 태그내에서 사용할 수 있으며 v-html속성을 사용해서 "html"로 렌더링한다. 
                    이 때 렌더링된 텍스트는 해당 태그의 자식 노드로 들어간다.

                    v-bind : 
                    특정 태그내에서 사용할 수 있으며 v-bind문법을 사용해서 vue내부의 값
                    (data, props, computed, methods)들의 값을 해당 속성의 값으로 렌더링한다.
                 */
            
            
            
                
        })
    </script>
</head>

<body>
    <h1 class="tit">
        <tit-comp></tit-comp>
    </h1>
    <div class="grid">
        <!-- 여기가 '부모'요소 위치 -->
        <list-comp v-for="(n,idx) in 50" v-bind:key="n" v-bind:haha="n" v-bind:myseq="idx" v-bind:endlet = "'WD'" v-on:hull="goMsg"></list-comp>
        <!-- 
            v-on:hull="goMsg"
            해석) 세상에 없는 이벤트인 hull 이벤트에 자기자신의 메서드인 goMsg를 호출함
            -> 자식 컴포넌트의 $emit(hull)로 연결됨
         -->
        <!-- 
            v-bind:haha="n"
            -> haha라는 내가 지은 이름의 속성에 값으로 for문 순회시 생성된 n변수를 할당해 준다
            -> 이것을 이용하여 자식 컴포넌트 인스턴스에 옵션으로 props:[내가만든변수]를 써서
                사용할 수 있음
            -> 이것이 부모 데이터를 자식 컴포넌트에 전달하는 방법

            -> 만약 props로 내부 데이터 전달하지 않으면 일반적으로 사용하는 사용자정의속성으로 태그에 표시됨
                이렇게 사용하는 속성이라면 "data-이름" 형식을 지켜야함. 하지만 props로 사용하는 변수명은 지킬 필요 없음

            -> props로 사용할 속성변수는 요소의 속성이므로 소문자로 작성하고 호출시 props 내부에서 소문자로 세팅한다
                (대문자를 섞어써도 결과적으로 소문자로 읽혀진다)

            -> 속성변수의 내용을 문자형으로 쓰려면 쌍따옴표 내부에 홑따옴표로 사용해야 함.
            -->


        <!-- 
            v-for 디렉티브에 in 뒤에 숫자를 작성하면 그 개수만큼 실행함 
            - 개별숫자 데이터는 1부터 개수만큼 하나씩 할당됨

            주의: 반복문 속성을 사용할 경우 삭제, 추가, 변경사항을 Vue JS에서 구분하기 위하여
                    하나하나의 항목을 DB레코드 구분하듯이 구분 키를 넣어줄것을 강력하게 요청함
                    제이슨 데이터 등을 가져왔다면 유일키에 해당하는 항목을 아래와 같이 설정하여
                    속성바인딩 처리 한다.
                    예)
                    <div v-bind:key="값">
                    참고) v-bind를 사용할 경우 일반적으로 생략 가능함
                        예)
                        <div :key="값">

                    -> 여기서는 제이슨 데이터, 객체데이터가 아니므로  for 문 돌릴때 숫자로 할당된 n을 primary key로 사용한다.
        -->
    </div>
    <h2 class="tit2">
        <tit-comp></tit-comp>
    </h2>
</body>

</html>